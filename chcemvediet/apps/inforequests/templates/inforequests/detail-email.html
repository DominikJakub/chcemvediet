{# vim: set filetype=htmldjango :#}
{% load squeeze from poleno.utils %}
{% load blocktrans from i18n %}

{% comment %}
 %
 % Context:
 %  -- inforequest: chcemvediet.apps.inforequests.models.Inforequest
 %  -- email: poleno.mail.models.Message
 %
{% endcomment %}

<div class="row-fluid">
  <p class="span2 text-right">{% blocktrans %}Subject{% endblocktrans %}:</p>
  <p class="span10">{{ email.subject }}</p>
</div>
<div class="row-fluid">
  <p class="span2 text-right">{% blocktrans %}From{% endblocktrans %}:</p>
  <p class="span10">{{ email.from_full }}</p>
</div>
<div class="row-fluid">
  <p class="span2 text-right">{% blocktrans %}To{% endblocktrans %}:</p>
  <p class="span10">
    {% for recipient in email.recipient_set.all %}
      {% filter squeeze %}
        {% if recipient.mail == email.received_for %}
          <b>{{ recipient.full }}</b>
        {% else %}
          <span>{{ recipient.full }}</span>
        {% endif %}
      {% endfilter %}{% if not forloop.last %},{% endif %}
    {% endfor %}
  </p>
</div>
<div class="row-fluid">
  <p class="span2 text-right">{% blocktrans %}Received{% endblocktrans %}:</p>
  <p class="span10">{{ email.processed }}</p>
</div>
{% if email.attachment_set.exists %}
  <div class="row-fluid">
    <p class="span2 text-right">Attachments:</p>
    <p class="span10">
      {% for attachment in email.attachment_set.all %}
        <a href="{% url 'attachments:mail_download' attachment.id %}"><span class="label label-info">{{ attachment.name }}</span></a>
      {% endfor %}
    </p>
  </div>
{% endif %}
<div class="row-fluid">
  <p class="span12" style="white-space: pre-line;">{{ email.text }}</p>
</div>
